<?xml version="1.0"?>
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
	<xsl:import href="db://resource/xslt/request/bloomberg/BBMortgagePoolNonPoolImport.xslt"/>
	<xsl:param name="Firmname" select="'Please specify the firmname in the configuration of the service'"></xsl:param>
	<xsl:output method="text"/>
	<xsl:template match="/VendorRequest">START-OF-FILE
FIRMNAME=<xsl:value-of select="$Firmname"/>
DATEFORMAT=yyyymmdd
PROGRAMNAME=getdata<xsl:if test="/VendorRequest/Request/Param[@Key='DATERANGE']">
DATERANGE=<xsl:value-of select="/VendorRequest/Request/Param[@Key='DATERANGE']"/></xsl:if>
<xsl:if test="/VendorRequest/Request/Param[@Key='ACTIONS']">
ACTIONS=<xsl:value-of select="/VendorRequest/Request/Param[@Key='ACTIONS']"/></xsl:if>
<xsl:if test="/VendorRequest/Request/Param[@Key='ACTIONS_DATE']">
ACTIONS_DATE=<xsl:value-of select="/VendorRequest/Request/Param[@Key='ACTIONS_DATE']"/></xsl:if>
<xsl:if test="/VendorRequest/ProgramFlag/text()">
PROGRAMFLAG=<xsl:value-of select="/VendorRequest/ProgramFlag/text()"/></xsl:if>
<xsl:if test="/VendorRequest/Request/Param[@Key='Header_YELLOWKEY']">
YELLOWKEY=<xsl:value-of select="/VendorRequest/Request/Param[@Key='Header_YELLOWKEY']"/></xsl:if>
<xsl:if test="/VendorRequest/DiffFlag/text()">
DIFFFLAG=<xsl:value-of select="/VendorRequest/DiffFlag/text()"/></xsl:if>
<xsl:if test="/VendorRequest/RunDate/text()">
RUNDATE=<xsl:value-of select="/VendorRequest/RunDate/text()"/></xsl:if>
<xsl:if test="/VendorRequest/Time/text()">
TIME=<xsl:value-of select="/VendorRequest/Time/text()"/></xsl:if>
<xsl:if test="/VendorRequest/ReplyFileName/text()">
REPLYFILENAME=<xsl:value-of select="/VendorRequest/ReplyFileName/text()"/></xsl:if>
<xsl:call-template name="extra-header-fields"/>

START-OF-FIELDS
#BBRequestReplyFile<xsl:if test="/VendorRequest/Request/RequestType='Mortgage Non Pool' or /VendorRequest/Request/RequestType='Mortgage Non PoolAddn'">
MARKET_SECTOR_DES
ID_BB_COMPANY
ID_BB_SECURITY
ID_CUSIP
ID_SEDOL1
ID_SEDOL2
ID_ISIN
SECURITY_TYP
TICKER
ID_BB_UNIQUE
AMT_OUTSTANDING
CNTRY_ISSUE_ISO
COUNTRY
CPN
CPN_ASOF_DT
CPN_FREQ
DAY_CNT_DES
DELIVERY_TYP
FIRST_SETTLE_DT
FLOATER
FLT_SPREAD
ID_BB
ISSUER
LAST_REFIX_DT
LEAD_MGR
LONG_COMP_NAME
MATURITY
MIN_DENOMINATION
MTG_AMT_OUT_FACE
MTG_CMO_CLASS
MTG_COLLAT_DT
MTG_COLLAT_SEASONING
MTG_DEAL_TYP
MTG_DTC_TYP
MTG_END_ACC_DT_SET_DT
MTG_FACE_AMT
MTG_FACT_SET_DT_STRT_NEXT_ACC_DT
MTG_FACTOR
MTG_FACTOR_DT
MTG_FACTOR_INT_PAY
MTG_FACTOR_NUM_DT
MTG_FACTOR_PAY_DT
MTG_FACTOR_PAY_RT
MTG_FACTOR_PRINC_PAY
MTG_FACTOR_SET_DT
MTG_FACTOR_SET_DT_END_ACC_DT
MTG_FACTOR_SET_DT_PAY_DT
MTG_FACTOR_SET_DT_START_ACC_DT
MTG_FIRST_PAY_DT
MTG_FIRST_RST_DT
MTG_INT_DEFERRED
MTG_INT_DIST
MTG_INT_SHORTFALL
MTG_LIFE_CAP
MTG_LIFE_FLOOR
MTG_LOAN_AGE
MTG_MIN_INCREMENT
MTG_NOTL_PRINC_FLAG
MTG_NXT_PAY_DT_SET_DT
MTG_ORIG_WAC
MTG_ORIG_WAL
MTG_ORIG_WAM
MTG_PAY_DELAY
MTG_PAY_METHOD
MTG_PRINC_DIST
MTG_PRINC_LOSSES
MTG_RECORD_DT
MTG_RESET_SLOPE
MTG_SERV
MTG_START_ACC_DT_SET_DT
MTG_TRANCHE_TYP_LONG
MTG_TRUSTEE
MTG_TYP
MTG_WAM
NXT_CPN_DT
NXT_REFIX_DT
PAR_AMT
PREV_CPN_DT
REFIX_FREQ
RESET_IDX
CRNCY
NAME
INDUSTRY_SECTOR
INDUSTRY_GROUP
INDUSTRY_SUBGROUP
COUNTRY_ISO
MTG_CMO_SERIES
MTG_PREPAY_TYP
MTG_PREPAY_SPEED
ISSUE_DT
INDUSTRY_SUBGROUP_NUM
144A_FLAG
MTG_WACPN
MTG_COLLAT_TYP
MTG_CMO_GROUP
MTG_WAL
CPN_TYP
BASIC_SPREAD
ID_COMMON
SEDOL1_COUNTRY_ISO
SEDOL2_COUNTRY_ISO
ID_MIC1
SEC_DATE_2A_7
MTG_CLASS_DEAL_PCT_ORIG
MTG_CLASS_DEAL_PCT_CURR
ID_CUSIP_REAL
SECURITY_TYP2
EU_SAVINGS_DIRECTIVE
MTG_IS_PAID_OFF
ID_BB_PARENT_CO
PARENT_COMP_NAME
CNTRY_COLLAT_ISO
CALLABLE
NXT_CALL_DT
NXT_CALL_PX
OID_BOND
ISSUE_PX
MTG_SMMEA_STAT
MTG_GEN_TICKER
MTG_HIST_1ST_PRINC_PAY_DT
FIRST_CPN_DT
MTG_PREPAY_SOURCE
SECURITY_DES
IS_REG_S
MTG_COLLAT_GROUP
MTG_WAL_CALL
MTG_PREV_FACTOR
MTG_PREV_FACTOR_DT
MTG_PREV_FACTOR_NUM_DT
FLT_SPREAD_AFTER_STEP
MTG_CRED_PROV
MTG_IS_AGENCY_BACKED
DAYS_TO_SETTLE
REMOVAL_REASON
START_ACC_DT
END_ACC_DT
MTG_FINAL_PAY_DT
CFI_CODE
SECURITY_FACTORABLE
122A_ELIGIBLE
122A_RETENTION_METHOD
ID_BB_GLOBAL
MTG_DEAL_NAME
FACTOR_EFFECTIVE_DATE
FEED_SOURCE
ID_BB_SEC_NUM_DES
INDUSTRY_GROUP_NUM
INDUSTRY_SECTOR_NUM
NOMINAL_PAYMENT_DAY</xsl:if><xsl:comment> end for non pool </xsl:comment><xsl:if test="/VendorRequest/Request/RequestType='MortgagePools' or /VendorRequest/Request/RequestType='MortgagePoolsAddn'">
MARKET_SECTOR_DES
ID_BB_COMPANY
ID_BB_SECURITY
ID_CUSIP
ID_ISIN
TICKER
SECURITY_TYP
ID_BB_UNIQUE
AMT_OUTSTANDING
BASIC_SPREAD
CNTRY_ISSUE_ISO
CONVERTIBLE
CPN
CPN_FREQ
DAY_CNT_DES
FIRST_CPN_DT
FLOATER
FLT_SPREAD
ID_BB_PARENT_CO
ISSUE_DT
ISSUER_BULK
LAST_REFIX_DT
LONG_COMP_NAME
MATURITY
MTG_AMORT_TYP
MTG_AMORT_WAM
MTG_AMT_OUT_FACE
MTG_ARM_SUBTYP
MTG_ARM_TRANSFER_TYP
MTG_ARM_ACC_RT_STRUCT
MTG_BALLOON_WAM
MTG_CNVS_PER_BEG
MTG_CNVS_PER_END
MTG_COMPLIANCE_CODE
MTG_CUR_PAY_RT
MTG_EST_ACC_RT
MTG_FACTOR
MTG_FACTOR_INT_PAY
MTG_FACTOR_NUM_DT
MTG_FACTOR_PAY_DT
MTG_FACTOR_PAY_RT
MTG_FACTOR_PRINC_PAY
MTG_FIRST_RST_DT
MTG_GEO
MTG_IS_MEGA
MTG_LIFE_CAP
MTG_LIFE_FLOOR
MTG_LOAN_AGE
MTG_LOAN_MRGN
MTG_LOCK_WAM
MTG_LOOKBACK
MTG_MIN_INDX_MOV
MTG_MRG_DIFF
MTG_NEGAM_FACT
MTG_NEGAM_FACT_DT
MTG_NUM_ORIG_LOAN
MTG_NXT_ACC_PER_BEG
MTG_NXT_ADJ_DT
MTG_ORIG_ACC_RT
MTG_ORIG_AMT
MTG_ORIG_CPN_HIGH
MTG_ORIG_CPN_LOW
MTG_ORIG_LCAP_HIGH
MTG_ORIG_LCAP_LOW
MTG_ORIG_LFLOOR_AVG
MTG_ORIG_LFLOOR_HIGH
MTG_ORIG_LFLOOR_LOW
MTG_ORIG_LIFE_CAP
MTG_ORIG_MRGN_HIGH
MTG_ORIG_MRGN_LOW
MTG_ORIG_RMTY_HIGH
MTG_ORIG_RMTY_LOW
MTG_ORIG_SERV_LINE1
MTG_ORIG_SERV_LINE2
MTG_ORIG_SERV_LINE3
MTG_ORIG_SERV_LINE4
MTG_ORIG_WAC
MTG_ORIG_WAM
MTG_PAY_CAP
MTG_PAY_CHG_FREQ
MTG_PAY_DELAY
MTG_PAY_RT
MTG_PER_RT_CAP
MTG_POOL_ALPHA
MTG_POOL_NUMBER
MTG_POOL_TYP
MTG_PREV_CPN
MTG_PREV_FACTOR
MTG_PREV_FACTOR_NUM_DT
MTG_RT_CHG_FREQ
MTG_STATED_WALA
MTG_STATED_WARM
MTG_WA_COMP_MA
MTG_WA_NEG_AM_LIMIT
MTG_WAC_CALC
MTG_WACPN
MTG_WALA_CALC
MTG_WAM
MTG_WAM_NXT_RST
MTG_WHLN_NUMBER_LOAN
NXT_REFIX_DT
REFIX_FREQ_M
RESET_IDX
CRNCY
NAME
INDUSTRY_SECTOR
INDUSTRY_GROUP
INDUSTRY_SUBGROUP
COUNTRY_ISO
MTG_FACT_SET_DT_STRT_NEXT_ACC_DT
MTG_END_ACC_DT_SET_DT
MTG_PREPAY_TYP
MTG_PREPAY_SPEED
INDUSTRY_SUBGROUP_NUM
MTG_COLLAT_TYP
MTG_WAL
CPN_TYP
MTG_START_ACC_DT_SET_DT
SEC_DATE_2A_7
PREV_CPN_DT
NXT_CPN_DT
ID_CUSIP_REAL
SECURITY_TYP2
EU_SAVINGS_DIRECTIVE
MTG_IS_PAID_OFF
PARENT_COMP_NAME
MTG_GEN_TICKER
FIRST_SETTLE_DT
MTG_PREPAY_SOURCE
SECURITY_DES
END_ACC_DT
START_ACC_DT
MTG_FINAL_PAY_DT
SECURITY_FACTORABLE
ID_BB_GLOBAL
FACTOR_EFFECTIVE_DATE
FEED_SOURCE
ID_BB_SEC_NUM_DES</xsl:if><xsl:comment> end for mortgage pool </xsl:comment><xsl:if test="/VendorRequest/Request/RequestType='BBMortgageNonPoolABSPricing'">
MARKET_SECTOR_DES
ID_BB_COMPANY
ID_BB_SECURITY
ID_BB_UNIQUE
ID_CUSIP
ID_ISIN
SECURITY_TYP
TICKER
CPN
NAME
ISSUER
ISSUE_DT
COUNTRY_ISO
CRNCY
SETTLE_DT
PX_BID
PX_MID
PX_ASK
PX_LAST
LAST_UPDATE_DT
PRICING_SOURCE
ISSUE_PX
MATURITY
MTG_PREPAY_SPEED
MTG_PREPAY_TYP
MTG_PX_SPD
INT_ACC
YLD_CNV_MID
YLD_YTM_MID
DISC_MRGN_MID
MTG_WAL
MTG_WAL_SPREAD_MID
MTG_START_PRINC_WNDW_MTY
MTG_END_PRINC_WNDW_MTY
MTG_WACPN
MTG_WHLN_WALA
MTG_EXS_SPREAD
MTG_WHLN_CRED_SUP
MTG_WHLN_30DLQ
MTG_WHLN_60DLQ
MTG_WHLN_90DLQ
ID_SEDOL1
ID_SEDOL2
SEDOL1_COUNTRY_ISO
SEDOL2_COUNTRY_ISO
ID_MIC1
ID_MIC2
ID_BB_GLOBAL
ID_BB_SEC_NUM_DES
FEED_SOURCE</xsl:if><xsl:comment> end for non pool abs pricing </xsl:comment><xsl:if test="/VendorRequest/Request/RequestType='BB_DL_Mortgage_Fitch'">
ID_BB_COMPANY
ID_BB_SECURITY
ID_CUSIP
ID_ISIN
TICKER
ID_BB_UNIQUE
CPN
MATURITY
NAME
RTG_FITCH
RTG_FITCH_WATCH
RTG_FITCH_NO_WATCH
RTG_FITCH_WATCH_DT
FITCH_EFF_DT
RTG_FITCH_LONG
RTG_FITCH_SHRT
RTG_FITCH_LONG_RATING_DT
RTG_FITCH_SHRT_RATING_DT
RTG_FITCH_RATING_SUFFIX
ID_BB_GLOBAL
ID_BB_SEC_NUM_DES
FEED_SOURCE</xsl:if><xsl:comment> end for mortgage fitch </xsl:comment><xsl:if test="/VendorRequest/Request/RequestType='BB_DL_Mortgage_Moodys'">
ID_BB_COMPANY
ID_BB_SECURITY
ID_CUSIP
ID_ISIN
TICKER
ID_BB_UNIQUE
CPN
MATURITY
NAME
RTG_MOODY
RTG_MOODY_WATCH
RTG_MOODY_NO_WATCH
RTG_MOODY_WATCH_DT
MOODY_EFF_DT
RTG_MOODY_LONG_ISSUE_LEVEL
RTG_MOODY_SHRT
RTG_MDY_LONG_RATING_DT
RTG_MDY_SHRT_RATING_DT
RTG_MOODY_SF_INDICATOR
ID_BB_GLOBAL
RTG_MOODY_NATL_ENDORSEMENT_IND
RTG_MOODY_ENDORSEMENT_INDICATOR
RTG_MDY_OFFICE_JAPAN_FSA_REG
RTG_MDY_NSR_WATCH
RTG_MDY_NSR_DT
RTG_MDY_NSR
ID_BB_SEC_NUM_DES
FEED_SOURCE</xsl:if><xsl:comment> end for mortgage moodys </xsl:comment><xsl:if test="/VendorRequest/Request/RequestType='BB_DL_Mortgage_S&amp;P'">
ID_BB_COMPANY
ID_BB_SECURITY
ID_CUSIP
ID_ISIN
TICKER
ID_BB_UNIQUE
CPN
MATURITY
NAME
RTG_SP
RTG_SP_WATCH
RTG_SP_NO_WATCH
RTG_SP_WATCH_DT
SP_EFF_DT
RTG_SP_LONG
RTG_SP_SHRT
RTG_SP_LONG_RATING_DT
RTG_SP_SHRT_RATING_DT
ID_BB_GLOBAL
RTG_SP_REGULATORY_QUALIFIER
RTG_SP_ST_JAPAN_REGISTERED_IND
RTG_SP_ST_EXTENSION_INDICATOR
RTG_SP_ST_EU_RATED_INDICATOR
RTG_SP_ST_ENDORSEMENT_INDICATOR
RTG_SP_NATL_ST_JPN_REG_IND
RTG_SP_NATL_ST_EU_RATED_IND
RTG_SP_NATL_LT_JPN_REG_IND
RTG_SP_NATL_LT_EU_RATED_IND
RTG_SP_LT_JAPAN_REGISTERED_IND
RTG_SP_LT_EXTENSION_INDICATOR
RTG_SP_LT_EU_RATED_INDICATOR
RTG_SP_LT_ENDORSEMENT_INDICATOR
ID_BB_SEC_NUM_DES
FEED_SOURCE</xsl:if><xsl:comment> end for mortgage snp </xsl:comment><xsl:if test="/VendorRequest/Request/RequestType='BB_DL_Mortgage_DBRS'">
ID_BB_COMPANY
ID_BB_SECURITY
ID_CUSIP
ID_ISIN
TICKER
ID_BB_UNIQUE
CPN
MATURITY
NAME
RTG_DBRS
RTG_DBRS_WATCH
DBRS_EFF_DT
ID_BB_GLOBAL
RTG_DBRS_MODIFIER
ID_BB_SEC_NUM_DES
FEED_SOURCE</xsl:if><xsl:comment> end of Mortgage_DBRS</xsl:comment>
<xsl:call-template name="extra-fields"/>
END-OF-FIELDS

START-OF-DATA
<xsl:apply-templates select="Request"/>END-OF-DATA
END-OF-FILE</xsl:template>
	<xsl:template match="Request">#Identifier=<xsl:value-of select="Identifier"/>|<xsl:for-each select="OID"><xsl:value-of select="text()"/><xsl:if test="position()!=last()"><xsl:text>,</xsl:text></xsl:if></xsl:for-each>|<xsl:for-each select="MSGTYP"><xsl:value-of select="text()"/><xsl:if test="position()!=last()"><xsl:text>,</xsl:text></xsl:if></xsl:for-each><xsl:text>
</xsl:text>
	<xsl:value-of select="Identifier"/><xsl:text> </xsl:text>
	<xsl:if test="Param[@Key='Header_YELLOWKEY']"><xsl:value-of select="Param[@Key='Header_YELLOWKEY']"/><xsl:text> </xsl:text></xsl:if>
	<xsl:if test="Param[@Key='Exchange']"><xsl:value-of select="Param[@Key='Exchange']"/><xsl:text> </xsl:text></xsl:if>
	<xsl:if test="Param[@Key='MarketSector']"><xsl:value-of select="Param[@Key='MarketSector']"/><xsl:text> </xsl:text></xsl:if>| <xsl:value-of select="IDContext"/><xsl:text>
</xsl:text></xsl:template>
</xsl:stylesheet><!-- Stylus Studio meta-information - (c) 2004-2005. Progress Software Corporation. All rights reserved.
<metaInformation>
<scenarios/><MapperMetaTag><MapperInfo srcSchemaPathIsRelative="yes" srcSchemaInterpretAsXML="no" destSchemaPath="" destSchemaRoot="" destSchemaPathIsRelative="yes" destSchemaInterpretAsXML="no"/><MapperBlockPosition></MapperBlockPosition><TemplateContext></TemplateContext><MapperFilter side="source"></MapperFilter></MapperMetaTag>
</metaInformation>
-->